= Module 1 - VM Foundations with OpenShift LightSpeed

include::vars.adoc[]

== OpenShift Virtualization Introduction and Feature Review

OpenShift Virtualization provides scalable, enterprise-grade virtualization functionality as a feature in Red Hat OpenShift. You can use it to manage virtual machines (VMs) exclusively or alongside container workloads.

image::rh1/02-ocp-virt-arch.png[link="self", window=blank, width="100%"]

OpenShift Virtualization adds new objects into your OpenShift Container Platform cluster by using Kubernetes custom resources to enable virtualization tasks. These tasks include:

* Creating and managing Linux and Windows VMs
* Running pod and VM workloads alongside each other in a cluster
* Connecting to VMs through a variety of consoles and CLI tools
* Importing and cloning existing VMs
* Managing network interface controllers and storage disks attached to VMs
* Live migrating VMs between nodes


== Objectives

* The attendee will participate in a brief review of OpenShift Virtualization features.
* The attendee will create a simple VM by reviewing provisioning options available in OpenShift Virtualization.
* The attendee will create a custom VM by providing intructions to OpenShift Lightspeed for assistance.
* The attendee will troubleshoot a VM deployment failure using OpenShift LightSpeed.

[[explore-openshift-virt]]
== Getting Started with OpenShift Virtualization

Log into your console with the username and password provided in the introduction section.

You will be welcomed to the new OpenShift UI, please click on *Skip tour* on this window.

image::rh1/03-welcome-to-openshift.png[link="self", window=blank, width="100%"]

Also, you may notice that the *OpenShift LightSpeed* window is taking up a significant amount of console real estate on initial launch, please minimize this window for now until we are ready to use it.

image::rh1/04-minimize-lightspeed.png[link="self", window=blank, width="100%"]

Please note that you have a dedicated set of projects for your user account to make use of during this lab as well as access to the default project for openshift-virtualization-os-images allowing you to access default virtual machine images.

image::rh1/05-user-project-list.png[link="self", window=blank, width="100%"]

Navigate to the OpenShift Virtualization console by clicking on *Virtualization -> VirtualMachines* in the left-side navigation menu.

image::rh1/06-virt-navigation.png[link="self", window=blank, width="100%"]

Click on the {user}-travel-agency namespace in the center column to see that there are already a number of virtual machines running in the cluster.

image::rh1/07-vms-overview.png[link="self", window=blank, width="100%"]

We will now explore some default configurations and metrics from a running VM.

Click on the VM named `cars-vm`, this directs you to the VM Overview page.

On this page you will find:

- Other tabs dedicated to Metrics, Configuration, Events, and other useful tools in tabs near the top. 
- State management buttons and the dropdown Actions menu in the top-right.
- Basic utilization information metrics in the bottom-center.

image::rh1/08-cars-vm-detail.png[link="self", window=blank, width="100%"]

For a deeper look at metrics, click on the `Metrics` tab. 

This gives you an overview of the VM metrics like memory and CPU consumption, storage and networking performance data if you scroll down the page.

image::rh1/09-cars-vm-metrics.png[link="self", window=blank, width="100%"]

For a deeper look at the configuration options that can be modified on the VM, click on the `Configuration` tab.

This gives you an overview of the VM configuration options that can be modified including CPU and Memory, as well as Storage, Networking, and Scheduling options that are avaialble in the sub menus. Feel free to click through these menus to see the tuneable options that are avaialble to you.

image::rh1/10-cars-vm-config.png[link="self", window=blank, width="100%"]


In this introduction section we have explored the Virtualization Dashboard in the OpenShift console and the sub-tabs for Metrics and Configuration. Now we will proceed with additional tasks in OpenShift.

[[quick-create-vm]]
== Quick Create a Virtual Machine

Begin this task by creating a project to organize the virtual machines you will be creating in this and the following sections.

Click on the `Create Project` button in the center column.

image::rh1/11-create-project-button.png[link="self", window=blank, width="100%"] 

A new window will launch, name your project {user}-vms, leave the other fields blank, and click on the `Create` button.

image::rh1/12-create-project-window.png[link="self", window=blank, width="100%"]

NOTE: The images in this guide will be static to the user that they were captured under, but the instructions should be dynamic to your particular user account. Please be sure to create things as your designated user.

You will be placed in this new project after it is created. Click the `Create VirtualMachine` button in the middle, and select `From template` from the dropdown menu to create your virtual machine.

image::rh1/13-create-vm-button.png[link="self", window=blank, width="100%"]

You will see the templates for both Linux and Windows VMs that are available to you arranged in a number of tiles. Click on the `Red Hat Enterprise Linux 9 VM` tile to create a RHEL9 VM.

image::rh1/14-template-catalog.png[link="self", window=blank, width="100%"]

A new window will appear allowing you to configure things like a bootable CD image, modify the disk size of the VM, and configure it's CPU and Memory resources as well as name the VM. For the purpose of this exercise, just name the virtual machine `{user}-rhel9` and click the `Quick create VirtualMachine` button at the bottom.

image::rh1/15-quick-create-vm.png[link="self", window=blank, width="100%"]

You will be taken to the VirtualMachine details page withe `Overview` tab just as before where you will see the VM enter the `Provisioning` stage, followed by the `Starting` and finally the `Running` stage when it is up and ready.

image::rh1/16-quick-create-vm-overview.png[link="self", window=blank, width="100%"]

You can click on `Console` tab to see that the machine is running.

image::rh1/17-quick-create-vm-console.png[link="self", window=blank, width="100%"]


[[create-lightspeed]]
== Create a VM with OpenShift Lightspeed



[[troubleshoot-lightspeed]]
== Troubleshoot a VM with OpenShift Lightspeed


